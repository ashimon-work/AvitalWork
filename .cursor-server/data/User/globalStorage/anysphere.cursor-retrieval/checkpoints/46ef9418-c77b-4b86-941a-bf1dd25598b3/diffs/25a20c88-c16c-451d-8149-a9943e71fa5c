{"fsPath":"\\home\\racheli\\project\\backend\\api\\src\\products\\products.service.ts","fileUuid":"25a20c88-c16c-451d-8149-a9943e71fa5c","fileSizeBytes":23521,"numLines":738,"diffChanges":[{"originalStartLineNumberOneIndexed":222,"originalEndLineNumberExclusiveOneIndexed":222,"modifiedStartLineNumberOneIndexed":222,"modifiedEndLineNumberExclusiveOneIndexed":223,"addedLines":["      // Use the join table directly for more reliable filtering"],"tokenizedAddedLines":[1000435]},{"originalStartLineNumberOneIndexed":225,"originalEndLineNumberExclusiveOneIndexed":228,"modifiedStartLineNumberOneIndexed":226,"modifiedEndLineNumberExclusiveOneIndexed":232,"addedLines":["        .innerJoin(","          'product_categories',","          'pc',","          'pc.productId = product.id AND pc.categoryId = :categoryId',","          { categoryId: params.category_id },","        )"],"tokenizedAddedLines":[1000436,1000437,1000438,1000439,1000440,1000441]},{"originalStartLineNumberOneIndexed":290,"originalEndLineNumberExclusiveOneIndexed":290,"modifiedStartLineNumberOneIndexed":294,"modifiedEndLineNumberExclusiveOneIndexed":295,"addedLines":["      const parameters = queryBuilder.getParameters();"],"tokenizedAddedLines":[1000442]},{"originalStartLineNumberOneIndexed":291,"originalEndLineNumberExclusiveOneIndexed":291,"modifiedStartLineNumberOneIndexed":296,"modifiedEndLineNumberExclusiveOneIndexed":297,"addedLines":["      this.logger.log(`[ProductsService] SQL Parameters: ${JSON.stringify(parameters)}`);"],"tokenizedAddedLines":[1000443]},{"originalStartLineNumberOneIndexed":295,"originalEndLineNumberExclusiveOneIndexed":295,"modifiedStartLineNumberOneIndexed":301,"modifiedEndLineNumberExclusiveOneIndexed":322,"addedLines":["      if (total === 0) {","        this.logger.warn(","          `[ProductsService] No products found for category ${params.category_id}. Checking if products exist...`,","        );","        // Debug: Check if any products exist for this store","        const allProducts = await this.productsRepository.find({","          where: { isActive: true, store: { slug: params.storeSlug } },","          relations: ['categories'],","          take: 5,","        });","        this.logger.log(","          `[ProductsService] Sample products in store (first 5): ${allProducts.length} found`,","        );","        if (allProducts.length > 0) {","          this.logger.log(","            `[ProductsService] First product categories: ${JSON.stringify(","              allProducts[0].categories?.map((c) => ({ id: c.id, name: c.name })),","            )}`,","          );","        }","      }"],"tokenizedAddedLines":[1000444,74,1000445,69,1000446,1000447,1000448,1000449,1000450,167,1000451,1000452,69,1000453,1000454,1000455,1000456,1000457,408,348,71]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}