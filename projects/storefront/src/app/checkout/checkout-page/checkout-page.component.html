<div class="checkout-page">
  <header class="checkout-page__header">
    <div class="checkout-page__container">
      <app-checkout-progress-indicator [currentStep]="2"></app-checkout-progress-indicator>
    </div>
  </header>
  <main class="checkout-page__main">
    <div class="checkout-page__grid">
      <div class="checkout-page__grid-left">
        <app-shipping-address-form (formUpdate)="handleShippingSubmit($event)"></app-shipping-address-form>
        <app-shipping-method
          [shippingMethods]="(shippingMethods$ | async) || []"
          [selectedMethod]="selectedShippingMethod"
          (selectionChange)="handleShippingMethodChange($event)">
        </app-shipping-method>
        <app-payment-method-section
          [storedCard]="storedCard"
          (cardUpdate)="handleCardUpdate($event)">
        </app-payment-method-section>
      </div>
      <div class="checkout-page__grid-right">
        <app-order-summary-card
          [items]="orderItems"
          [shipping]="selectedShippingMethod?.cost || 0"
          [taxes]="(taxEstimate$ | async) || 0"
          [canPlaceOrder]="canPlaceOrder()"
          [isPlacingOrder]="isLoading"
          (placeOrder)="placeOrder()">
        </app-order-summary-card>
      </div>
    </div>
  </main>
</div>
