<h3>My Orders</h3>

<!-- Loading Indicator -->
<div *ngIf="isLoading" class="loading-indicator">Loading orders...</div>

<!-- Order List -->
<ng-container *ngIf="(orders$ | async) as orders">
  <div *ngIf="orders.length > 0; else noOrders" class="order-list">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>Order #</th>
          <th>Date</th>
          <th>Status</th>
          <th>Total</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let order of orders">
          <td>{{ order.orderNumber || order.orderReference }}</td> <!-- Use orderNumber if available -->
          <td>{{ order.orderDate | date:'medium' }}</td>
          <td>
            <span class="badge" [ngClass]="{
              'bg-success': order.status === 'Completed' || order.status === 'Shipped',
              'bg-warning text-dark': order.status === 'Processing' || order.status === 'Pending',
              'bg-danger': order.status === 'Cancelled' || order.status === 'Refunded',
              'bg-info text-dark': order.status === 'Partially Shipped',
              'bg-secondary': !['Completed', 'Shipped', 'Processing', 'Pending', 'Cancelled', 'Refunded', 'Partially Shipped'].includes(order.status)
            }">{{ order.status | titlecase }}</span>
          </td>
          <td>{{ order.totalAmount | currency }}</td>
          <td>
            <a [routerLink]="['/account/orders', order.id]" class="btn btn-sm btn-outline-primary">View Details</a>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination Controls -->
    <nav *ngIf="(totalOrders$ | async) as total" aria-label="Order Pagination">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage === 1"> <!-- Use currentPage number property -->
          <a class="page-link" href="javascript:void(0)" (click)="goToPage(currentPage - 1)">&laquo;</a> <!-- Use currentPage number property -->
        </li>
        <!-- Generate page numbers -->
        <!-- Use totalPages$ observable -->
        <ng-container *ngIf="totalPages$ | async as totalPages">
          <ng-container *ngFor="let pageNum of [].constructor(totalPages); let i = index">
            <li class="page-item" [class.active]="currentPage === (i + 1)"> <!-- Use currentPage number property -->
            <a class="page-link" href="javascript:void(0)" (click)="goToPage(i + 1)">{{ i + 1 }}</a>
            </li>
          </ng-container>
        </ng-container> <!-- Close ngIf for totalPages$ -->
        <li class="page-item" [class.disabled]="currentPage === (totalPages$ | async)"> <!-- Use currentPage and totalPages$ -->
          <a class="page-link" href="javascript:void(0)" (click)="goToPage(currentPage + 1)">&raquo;</a> <!-- Use currentPage number property -->
        </li>
      </ul>
      <!-- Use totalPages$ observable -->
      <p *ngIf="totalPages$ | async as totalPages" class="text-center text-muted">Showing page {{ currentPage }} of {{ totalPages }}</p>
    </nav>

  </div>

  <ng-template #noOrders>
    <p>You haven't placed any orders yet.</p>
  </ng-template>
</ng-container>

<!-- Error Message Area (Optional) -->
<!-- <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div> -->
