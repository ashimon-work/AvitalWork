<h3>{{ tKeys.SF_ACCOUNT_PAYMENT_METHODS_TITLE | translate }}</h3>

<!-- Loading Indicator -->
<div *ngIf="isLoading && !(paymentMethods$ | async)" class="loading-indicator">{{
  tKeys.SF_ACCOUNT_PAYMENT_METHODS_LOADING | translate }}</div>

<!-- Success/Error Messages -->
<div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
<div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

<!-- Payment Method List -->
<ng-container *ngIf="(paymentMethods$ | async) as methods">
  <div *ngIf="methods.length > 0; else noMethods" class="payment-method-list">
    <div *ngFor="let method of methods" class="payment-method-card">
      <div class="card-details">
        <!-- Basic representation - enhance with icons later -->
        <span class="card-type">{{ method.cardBrand }}</span> {{ tKeys.SF_ACCOUNT_ENDING_IN | translate }} <span
          class="card-last4">{{ method.last4 }}</span>
        <span class="card-expiry">Expires: {{ method.expiryMonth | number:'2.0' }}/{{ method.expiryYear }}</span>
        <span *ngIf="method.isDefault" class="badge bg-primary ms-2">{{ tKeys.SF_ACCOUNT_PAYMENT_METHODS_DEFAULT_BADGE |
          translate }}</span>
      </div>
      <div class="method-actions">
        <!-- Edit functionality is complex and usually handled by payment provider flow -->
        <!-- <button class="btn btn-sm btn-outline-secondary me-2" [disabled]="isLoading">Edit</button> -->
        <button (click)="deletePaymentMethod(method.id)" class="btn btn-sm btn-outline-danger" [disabled]="isLoading">{{
          tKeys.SF_ACCOUNT_PAYMENT_METHODS_REMOVE_BUTTON | translate }}</button>
        <!-- Add Set Default button if backend supports it -->
        <!-- <button *ngIf="!method.isDefault" class="btn btn-sm btn-outline-primary ms-2" [disabled]="isLoading">Set as Default</button> -->
      </div>
    </div>
  </div>

  <ng-template #noMethods>
    <p>{{ tKeys.SF_ACCOUNT_PAYMENT_METHODS_NO_METHODS | translate }}</p>
    <p><small>{{ tKeys.SF_ACCOUNT_PAYMENT_METHODS_SAVE_NOTE | translate }}</small></p>
  </ng-template>
</ng-container>

<!-- Note: Adding new payment methods usually happens during checkout via a secure form/iframe provided by the payment processor -->