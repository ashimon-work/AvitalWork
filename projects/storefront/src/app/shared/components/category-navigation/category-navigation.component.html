<nav
  class="category-navigation"
  role="navigation"
  aria-label="Categories"
>
  <!-- Scroll left arrow - only show when content overflows -->
  <button
    *ngIf="showArrows"
    class="scroll-arrow scroll-left"
    (click)="scroll('left')"
    [disabled]="!canScrollLeft"
    aria-label="Scroll categories left"
  >
    <span class="arrow-icon">‹</span>
  </button>

  <!-- Categories container -->
  <div
    class="categories-container"
    #scrollContainer
    [class.scrollable]="enableScrolling"
  >
    <!-- Loading state -->
    <div *ngIf="categories$ | async as categories; else loadingTemplate">
      <!-- Categories loaded -->
      <ul *ngIf="categories.length > 0; else emptyTemplate" class="nav-list" #navList>
        <li
          class="nav-item"
          *ngFor="let category of categories; trackBy: trackByCategoryId"
        >
          <a
            class="nav-link"
            [class.active]="currentCategoryId === category.id"
            [attr.aria-label]="category.name"
            (click)="onCategoryClick(category)"
          >
            <div class="category-image">
              <img
                [src]="
                  category.imageUrl || 'assets/images/default-category.jpg'
                "
                [alt]="category.name"
                (error)="onImageError($event)"
              />
            </div>
            <span class="category-name">{{ category.name }}</span>
          </a>
        </li>
      </ul>
    </div>

    <!-- Loading template -->
    <ng-template #loadingTemplate>
      <div class="loading-placeholder">
        <div class="skeleton-item" *ngFor="let i of [1, 2, 3, 4]">
          <div class="skeleton-image"></div>
          <div class="skeleton-text"></div>
        </div>
      </div>
    </ng-template>

    <!-- Empty state template -->
    <ng-template #emptyTemplate>
      <div class="empty-state">No categories available</div>
    </ng-template>
  </div>

  <!-- Scroll right arrow - only show when content overflows -->
  <button
    *ngIf="showArrows"
    class="scroll-arrow scroll-right"
    (click)="scroll('right')"
    [disabled]="!canScrollRight"
    aria-label="Scroll categories right"
  >
    <span class="arrow-icon">›</span>
  </button>

  <!-- Scroll progress bar - only show when content overflows -->
  <div *ngIf="showProgressBar" class="scroll-progress">
    <div class="scroll-progress-bar" [style.width.%]="scrollProgress"></div>
  </div>
</nav>
