<nav class="category-navigation" role="navigation" aria-label="Categories">
  <!-- Scroll left arrow -->
  <button
    *ngIf="hasOverflow"
    class="scroll-arrow scroll-left"
    (click)="scroll('left')"
    [disabled]="!canScrollLeft"
    aria-label="Scroll categories left"
  >
    <span class="arrow-icon">‹</span>
  </button>

  <!-- Categories container -->
  <div
    class="categories-container"
    #scrollContainer
    [class.scrollable]="hasOverflow"
  >
    <!-- Categories / Loading -->
    <ng-container
      *ngIf="categories$ | async as categories; else loadingTemplate"
    >
      <!-- Categories list -->
      <ul
        *ngIf="categories.length > 0; else emptyTemplate"
        class="nav-list"
        #navList
      >
        <li
          class="nav-item"
          *ngFor="let category of categories; trackBy: trackByCategoryId"
        >
          <a
            class="nav-link"
            [class.active]="currentCategoryId === category.id"
            [attr.aria-current]="
              currentCategoryId === category.id ? 'true' : null
            "
            [attr.aria-label]="category.name"
            (click)="onCategoryClick(category)"
          >
            <div class="category-image">
              <img
                [src]="
                  category.imageUrl || 'assets/images/default-category.jpg'
                "
                [alt]="category.name"
                (error)="onImageError($event)"
              />
            </div>

            <span class="category-name">
              {{ category.name }}
            </span>
          </a>
        </li>
      </ul>
    </ng-container>

    <!-- Loading state -->
    <ng-template #loadingTemplate>
      <div class="loading-placeholder">
        <div class="skeleton-item" *ngFor="let _ of [1, 2, 3, 4]">
          <div class="skeleton-image"></div>
          <div class="skeleton-text"></div>
        </div>
      </div>
    </ng-template>

    <!-- Empty state -->
    <ng-template #emptyTemplate>
      <div class="empty-state">No categories available</div>
    </ng-template>
  </div>

  <!-- Scroll right arrow -->
  <button
    *ngIf="hasOverflow"
    class="scroll-arrow scroll-right"
    (click)="scroll('right')"
    [disabled]="!canScrollRight"
    aria-label="Scroll categories right"
  >
    <span class="arrow-icon">›</span>
  </button>

  <!-- Scroll progress -->
  <div *ngIf="hasOverflow" class="scroll-progress">
    <div class="scroll-progress-bar" [style.width.%]="scrollProgress"></div>
  </div>
</nav>
