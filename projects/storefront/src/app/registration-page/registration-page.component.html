<div class="registration-container">
      <h1>{{ tKeys.SF_REGISTRATION_PAGE_TITLE | translate }}</h1>

      <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()" novalidate>

        <!-- Success Message -->
        <div *ngIf="successMessage" class="alert alert-success">
          {{ successMessage }}
        </div>

        <!-- Error Message -->
        <div *ngIf="errorMessage" class="alert alert-danger">
          {{ errorMessage }}
        </div>

        <!-- First Name -->
        <div class="form-group">
          <label for="firstName">{{ tKeys.SF_REGISTRATION_FIRST_NAME_LABEL | translate }}</label>
          <input type="text" id="firstName" formControlName="firstName"
                 [ngClass]="{ 'is-invalid': firstName?.invalid && (firstName?.dirty || firstName?.touched) }">
          <div *ngIf="firstName?.invalid && (firstName?.dirty || firstName?.touched)" class="invalid-feedback">
            <div *ngIf="firstName?.errors?.['required']">{{ tKeys.SF_REGISTRATION_FIRST_NAME_REQUIRED_ERROR | translate }}</div>
            <div *ngIf="firstName?.errors?.['maxlength']">{{ tKeys.SF_REGISTRATION_FIRST_NAME_MAXLENGTH_ERROR | translate: 50 }}</div>
          </div>
        </div>

        <!-- Last Name -->
        <div class="form-group">
          <label for="lastName">{{ tKeys.SF_REGISTRATION_LAST_NAME_LABEL | translate }}</label>
          <input type="text" id="lastName" formControlName="lastName"
                 [ngClass]="{ 'is-invalid': lastName?.invalid && (lastName?.dirty || lastName?.touched) }">
          <div *ngIf="lastName?.invalid && (lastName?.dirty || lastName?.touched)" class="invalid-feedback">
            <div *ngIf="lastName?.errors?.['required']">{{ tKeys.SF_REGISTRATION_LAST_NAME_REQUIRED_ERROR | translate }}</div>
            <div *ngIf="lastName?.errors?.['maxlength']">{{ tKeys.SF_REGISTRATION_LAST_NAME_MAXLENGTH_ERROR | translate: 50 }}</div>
          </div>
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email">{{ tKeys.SF_REGISTRATION_EMAIL_LABEL | translate }}</label>
          <input type="email" id="email" formControlName="email"
                 [ngClass]="{ 'is-invalid': email?.invalid && (email?.dirty || email?.touched) }">
          <div *ngIf="email?.invalid && (email?.dirty || email?.touched)" class="invalid-feedback">
            <div *ngIf="email?.errors?.['required']">{{ tKeys.SF_REGISTRATION_EMAIL_REQUIRED_ERROR | translate }}</div>
            <div *ngIf="email?.errors?.['email']">{{ tKeys.SF_REGISTRATION_EMAIL_INVALID_ERROR | translate }}</div>
            <div *ngIf="email?.errors?.['maxlength']">{{ tKeys.SF_REGISTRATION_EMAIL_MAXLENGTH_ERROR | translate: 100 }}</div>
            <div *ngIf="email?.errors?.['emailExists']">{{ tKeys.SF_REGISTRATION_EMAIL_EXISTS_ERROR | translate }}</div>
          </div>
        </div>

        <!-- Password -->
        <div class="form-group">
          <label for="password">{{ tKeys.SF_REGISTRATION_PASSWORD_LABEL | translate }}</label>
          <input type="password" id="password" formControlName="password"
                 [ngClass]="{ 'is-invalid': password?.invalid && (password?.dirty || password?.touched) }">
          <div *ngIf="password?.invalid && (password?.dirty || password?.touched)" class="invalid-feedback">
            <div *ngIf="password?.errors?.['required']">{{ tKeys.SF_REGISTRATION_PASSWORD_REQUIRED_ERROR | translate }}</div>
            <div *ngIf="password?.errors?.['minlength']">{{ tKeys.SF_REGISTRATION_PASSWORD_MINLENGTH_ERROR | translate: 8 }}</div>
            <div *ngIf="password?.errors?.['maxlength']">{{ tKeys.SF_REGISTRATION_PASSWORD_MAXLENGTH_ERROR | translate: 100 }}</div>
            <div *ngIf="password?.errors?.['pattern']">{{ tKeys.SF_REGISTRATION_PASSWORD_PATTERN_ERROR | translate }}</div>
          </div>
          <!-- Placeholder for Password Strength Meter -->
          <div class="password-strength-meter">
            <!-- Implement strength visualization later (e.g., using a library or custom component) -->
            {{ tKeys.SF_REGISTRATION_PASSWORD_STRENGTH_PLACEHOLDER | translate }}
          </div>
          <ul class="password-requirements">
            <li>{{ tKeys.SF_REGISTRATION_PASSWORD_REQ_MIN_LENGTH | translate: 8 }}</li>
            <li>{{ tKeys.SF_REGISTRATION_PASSWORD_REQ_UPPER_LOWER | translate }}</li>
            <li>{{ tKeys.SF_REGISTRATION_PASSWORD_REQ_NUMBER | translate }}</li>
            <li>{{ tKeys.SF_REGISTRATION_PASSWORD_REQ_SPECIAL_CHAR | translate }}</li>
          </ul>
        </div>

        <!-- Confirm Password -->
        <div class="form-group">
          <label for="confirmPassword">{{ tKeys.SF_REGISTRATION_CONFIRM_PASSWORD_LABEL | translate }}</label>
          <input type="password" id="confirmPassword" formControlName="confirmPassword"
                 [ngClass]="{ 'is-invalid': (confirmPassword?.invalid || registrationForm.hasError('passwordMismatch')) && (confirmPassword?.dirty || confirmPassword?.touched) }">
          <div *ngIf="(confirmPassword?.invalid || registrationForm.hasError('passwordMismatch')) && (confirmPassword?.dirty || confirmPassword?.touched)" class="invalid-feedback">
            <div *ngIf="confirmPassword?.errors?.['required']">{{ tKeys.SF_REGISTRATION_CONFIRM_PASSWORD_REQUIRED_ERROR | translate }}</div>
            <div *ngIf="registrationForm.hasError('passwordMismatch') && !confirmPassword?.errors?.['required']">{{ tKeys.SF_REGISTRATION_PASSWORD_MISMATCH_ERROR | translate }}</div>
          </div>
        </div>

        <!-- Phone (Optional) -->
        <div class="form-group">
          <label for="phone">{{ tKeys.SF_REGISTRATION_PHONE_LABEL | translate }}</label>
          <input type="tel" id="phone" formControlName="phone"
                 [ngClass]="{ 'is-invalid': phone?.invalid && (phone?.dirty || phone?.touched) }">
          <div *ngIf="phone?.invalid && (phone?.dirty || phone?.touched)" class="invalid-feedback">
             <div *ngIf="phone?.errors?.['pattern']">{{ tKeys.SF_REGISTRATION_PHONE_INVALID_ERROR | translate }}</div>
             <div *ngIf="phone?.errors?.['maxlength']">{{ tKeys.SF_REGISTRATION_PHONE_MAXLENGTH_ERROR | translate: 20 }}</div>
          </div>
        </div>

        <!-- Newsletter Opt-in -->
        <div class="form-group form-check">
          <input type="checkbox" id="newsletterOptIn" formControlName="newsletterOptIn" class="form-check-input">
          <label for="newsletterOptIn" class="form-check-label">{{ tKeys.SF_REGISTRATION_NEWSLETTER_OPT_IN_LABEL | translate }}</label>
        </div>

        <!-- Terms and Conditions -->
        <div class="form-group form-check">
          <input type="checkbox" id="terms" formControlName="terms" class="form-check-input"
                 [ngClass]="{ 'is-invalid': terms?.invalid && (terms?.dirty || terms?.touched || submitted) }">
          <label for="terms" class="form-check-label">
            {{ tKeys.SF_REGISTRATION_TERMS_AGREE_TEXT | translate }} <a href="/terms-and-conditions" target="_blank">{{ tKeys.SF_REGISTRATION_TERMS_AND_CONDITIONS_LINK | translate }}</a> <!-- Link to actual terms page later -->
          </label>
          <div *ngIf="terms?.invalid && (terms?.dirty || terms?.touched || submitted)" class="invalid-feedback">
            {{ tKeys.SF_REGISTRATION_TERMS_REQUIRED_ERROR | translate }}
          </div>
        </div>

        <button type="submit" class="submit-btn" [disabled]="isSubmitting">
          {{ (isSubmitting ? tKeys.SF_REGISTRATION_SUBMIT_BUTTON_REGISTERING : tKeys.SF_REGISTRATION_SUBMIT_BUTTON_CREATE_ACCOUNT) | translate }}
        </button>

      </form>

      <div class="login-link">
        {{ tKeys.SF_REGISTRATION_ALREADY_HAVE_ACCOUNT_TEXT | translate }} <a [routerLink]="['../login']">{{ tKeys.SF_REGISTRATION_LOGIN_LINK_TEXT | translate }}</a> <!-- Use relative path -->
      </div>
    </div>
