<!-- Product Management Page -->
<div class="product-management-container d-flex">
  <!-- Advanced Filter Sidebar -->
  <aside class="advanced-filter-sidebar" [class.open]="showAdvancedFilters">
    <h4>{{ tKeys.SM_PRODUCT_MGMT_PAGE_ADVANCED_FILTERS_TITLE | translate }}</h4>
    <button class="btn-close close-sidebar-btn" [attr.aria-label]="tKeys.SM_PRODUCT_MGMT_PAGE_CLOSE_ARIA_LABEL | translate" (click)="toggleAdvancedFilters()"></button>
    <div class="mb-3">
      <label for="filterCategory" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_CATEGORY_LABEL | translate }}</label>
      <select class="form-select" id="filterCategory" [(ngModel)]="selectedCategory" (change)="onCategoryChange($event)">
        <option value="">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_ALL_CATEGORIES_OPTION | translate }}</option>
        <!-- TODO: Dynamically load categories from backend -->
        <option value="electronics">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_CATEGORY_ELECTRONICS_OPTION | translate }}</option>
        <option value="books">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_CATEGORY_BOOKS_OPTION | translate }}</option>
        <option value="clothing">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_CATEGORY_CLOTHING_OPTION | translate }}</option>
      </select>
    </div>
    <div class="mb-3">
      <label for="filterStatus" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STATUS_LABEL | translate }}</label>
      <select class="form-select" id="filterStatus" [(ngModel)]="selectedStatus" (change)="onStatusChange($event)">
        <option value="">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_ALL_STATUSES_OPTION | translate }}</option>
        <option value="active">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STATUS_ACTIVE_OPTION | translate }}</option>
        <option value="inactive">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STATUS_INACTIVE_OPTION | translate }}</option>
      </select>
    </div>
    <div class="mb-3">
      <label for="filterStockLevel" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STOCK_LEVEL_LABEL | translate }}</label>
      <select class="form-select" id="filterStockLevel" [(ngModel)]="selectedStockLevel" (change)="onStockLevelChange($event)">
        <option value="">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_ALL_STOCK_LEVELS_OPTION | translate }}</option>
        <option value="low">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STOCK_LOW_OPTION | translate }}</option>
        <option value="in-stock">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STOCK_IN_STOCK_OPTION | translate }}</option>
        <option value="out-of-stock">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STOCK_OUT_OF_STOCK_OPTION | translate }}</option>
      </select>
    </div>
    <!-- TODO: Add more filters like price range, tags, date added etc. -->
    <button class="btn btn-secondary w-100" (click)="applyAdvancedFilters()">{{ tKeys.SM_PRODUCT_MGMT_PAGE_APPLY_FILTERS_BUTTON | translate }}</button>
  </aside>

  <!-- Main Content Area -->
  <div class="main-content flex-grow-1 p-3">
    <h1>{{ tKeys.SM_PRODUCT_MGMT_PAGE_TITLE | translate }}</h1>

    <!-- Action Bar -->
    <div class="action-bar d-flex justify-content-between align-items-center mb-3">
      <div class="left-actions">
        <button class="btn btn-primary add-product-button me-2" (click)="openAddProductModal()">{{ tKeys.SM_PRODUCT_MGMT_PAGE_ADD_PRODUCT_BUTTON | translate }}</button>
        <button class="btn btn-outline-secondary toggle-filters-button" (click)="toggleAdvancedFilters()">
          <i class="fas fa-filter"></i> {{ (showAdvancedFilters ? tKeys.SM_PRODUCT_MGMT_PAGE_TOGGLE_FILTERS_HIDE_BUTTON : tKeys.SM_PRODUCT_MGMT_PAGE_TOGGLE_FILTERS_SHOW_BUTTON) | translate }}
        </button>
      </div>
      <div class="center-actions d-flex align-items-center">
        <input type="text" class="form-control search-input me-2" [placeholder]="tKeys.SM_PRODUCT_MGMT_PAGE_SEARCH_PLACEHOLDER | translate" [(ngModel)]="searchTerm"
          (input)="onSearchTermChange($event)">
      </div>
      <div class="bulk-actions d-flex align-items-center">
        <select class="form-select me-2" [(ngModel)]="selectedBulkAction" (change)="onBulkActionChange($event)">
          <option value="">{{ tKeys.SM_PRODUCT_MGMT_PAGE_BULK_ACTIONS_OPTION | translate }}</option>
          <option value="delete">{{ tKeys.SM_PRODUCT_MGMT_PAGE_BULK_ACTION_DELETE_SELECTED_OPTION | translate }}</option>
          <option value="update-status">{{ tKeys.SM_PRODUCT_MGMT_PAGE_BULK_ACTION_UPDATE_STATUS_OPTION | translate }}</option>
          <!-- Other bulk actions will be implemented later -->
        </select>
        <button class="btn btn-success me-2" (click)="exportProducts()" [disabled]="isLoadingExport">
          <span *ngIf="isLoadingExport" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          {{ tKeys.SM_PRODUCT_MGMT_PAGE_EXPORT_BUTTON | translate }}
        </button>
        <!-- Hidden file input for import -->
        <input type="file" id="productImportFile" style="display: none;" (change)="onFileSelected($event)"
          accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
        <!-- Button to trigger file selection -->
        <button class="btn btn-info me-2" onclick="document.getElementById('productImportFile').click()">{{ tKeys.SM_PRODUCT_MGMT_PAGE_SELECT_IMPORT_FILE_BUTTON | translate }}</button>
        <!-- Button to trigger import after file selection -->
        <button class="btn btn-primary" (click)="importProducts()" [disabled]="!selectedFile || isLoadingImport">
          <span *ngIf="isLoadingImport" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          {{ tKeys.SM_PRODUCT_MGMT_PAGE_IMPORT_BUTTON | translate }}
        </button>
        <!-- Status selection dropdown, visible only when 'Update Status' is selected -->
        <select class="form-select ms-2" *ngIf="selectedBulkAction === 'update-status'" [(ngModel)]="selectedBulkStatus"
          (change)="onBulkStatusChange($event)">
          <option value="">{{ tKeys.SM_PRODUCT_MGMT_PAGE_BULK_SELECT_STATUS_OPTION | translate }}</option>
          <option value="active">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STATUS_ACTIVE_OPTION | translate }}</option>
          <option value="inactive">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STATUS_INACTIVE_OPTION | translate }}</option>
        </select>
        <button class="btn btn-secondary ms-2"
          [disabled]="selectedProductIds.length === 0 || selectedBulkAction === '' || (selectedBulkAction === 'update-status' && selectedBulkStatus === '')"
          (click)="applyBulkAction()">{{ tKeys.SM_PRODUCT_MGMT_PAGE_BULK_APPLY_BUTTON | translate }}</button>
      </div>
    </div>

    <!-- Product Table -->
    <div class="product-table-container">
    <table class="table table-striped">
      <thead>
        <tr>
          <th><input type="checkbox" [(ngModel)]="selectAll" (change)="onSelectAllChange()"></th>
          <th>{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_IMAGE | translate }}</th>
          <th (click)="sortProducts('name')">{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_NAME | translate }} <span *ngIf="sortColumn === 'name'" class="sort-indicator">{{
              sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
          <th (click)="sortProducts('sku')">{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_SKU | translate }} <span *ngIf="sortColumn === 'sku'" class="sort-indicator">{{
              sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
          <th (click)="sortProducts('category')">{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_CATEGORY | translate }} <span *ngIf="sortColumn === 'category'"
              class="sort-indicator">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
          <th (click)="sortProducts('price')">{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_PRICE | translate }} <span *ngIf="sortColumn === 'price'" class="sort-indicator">{{
              sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
          <th (click)="sortProducts('stockQuantity')">{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_STOCK | translate }} <span *ngIf="sortColumn === 'stockQuantity'"
              class="sort-indicator">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
          <th (click)="sortProducts('status')">{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_STATUS | translate }} <span *ngIf="sortColumn === 'status'" class="sort-indicator">{{
              sortDirection === 'asc' ? '▲' : '▼' }}</span></th>
          <th>{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_ACTIONS | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <!-- Product rows will be dynamically loaded -->
        <tr *ngFor="let product of products">
          <td><input type="checkbox" [checked]="selectedProductIds.includes(product.id)"
              (change)="onProductSelected(product.id, $event)"></td>
          <td><img
              [src]="product.imageUrls && product.imageUrls.length > 0 ? product.imageUrls[0] : 'https://via.placeholder.com/50'"
              [alt]="tKeys.SM_PRODUCT_MGMT_PAGE_PRODUCT_IMAGE_ALT | translate" class="product-thumbnail"></td> <!-- Use first product image or placeholder -->
          <td>{{ product.name }}</td>
          <td>{{ product.sku }}</td>
          <td>{{ product.categoryIds && product.categoryIds.length > 0 ? product.categoryIds[0] : (tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_DATA_NA | translate) }}</td>
          <!-- Display first category ID or N/A -->
          <td>{{ product.price | currency }}</td> <!-- Assuming price is a number -->
          <td class="stock-level">{{ product.stockLevel }}</td> <!-- Use stockLevel -->
          <td class="status-indicator">{{ product.isActive ? (tKeys.SM_PRODUCT_MGMT_PAGE_STATUS_ACTIVE | translate) : (tKeys.SM_PRODUCT_MGMT_PAGE_STATUS_INACTIVE | translate) }}</td>
          <!-- Display status based on isActive -->
          <td>
            <button class="btn btn-sm btn-info me-1" (click)="openEditProductModal(product)">{{ tKeys.SM_PRODUCT_MGMT_PAGE_ACTION_EDIT | translate }}</button>
            <button class="btn btn-sm btn-secondary me-1"
              (click)="openDuplicateProductModal(product)">{{ tKeys.SM_PRODUCT_MGMT_PAGE_ACTION_DUPLICATE | translate }}</button>
            <button class="btn btn-sm btn-danger" (click)="deleteProduct(product)">{{ tKeys.SM_PRODUCT_MGMT_PAGE_ACTION_DELETE | translate }}</button>
          </td>
        </tr>
        <!-- Rows will be dynamically generated by *ngFor -->
      </tbody>
    </table>
  </div>

  <!-- Pagination Controls Placeholder -->
  <div class="pagination-controls d-flex justify-content-between align-items-center mt-3">
    <div class="product-count-summary">
      <p>{{ tKeys.SM_PRODUCT_MGMT_PAGE_PAGINATION_SUMMARY | translate:{ start: (currentPage - 1) * pageSize + 1, end: (currentPage - 1) * pageSize + (products.length), total: totalProducts } }}</p>
    </div>
    <div>
      <button class="btn btn-secondary me-1" [disabled]="currentPage === 1"
        (click)="onPageChange(currentPage - 1)">{{ tKeys.SM_PRODUCT_MGMT_PAGE_PAGINATION_PREVIOUS | translate }}</button>
      <span>{{ tKeys.SM_PRODUCT_MGMT_PAGE_PAGINATION_PAGE_INFO | translate:{ currentPage: currentPage, totalPages: totalPages } }}</span>
      <button class="btn btn-secondary ms-1" [disabled]="currentPage === totalPages"
        (click)="onPageChange(currentPage + 1)">{{ tKeys.SM_PRODUCT_MGMT_PAGE_PAGINATION_NEXT | translate }}</button>
    </div>
  </div>

  <!-- Product Count Summary Placeholder -->
  <!-- Advanced Filter Sidebar Placeholder -->
  <!-- This will be a separate component or a togglable section -->

  <!-- Advanced Filter Sidebar Placeholder -->
  <!-- Add/Edit Product Modal -->
  <!-- The modal structure remains largely the same, focusing on functionality implementation in TS -->

  <!-- Add/Edit Product Modal -->
  <div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addProductModalLabel">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_ADD_EDIT_TITLE | translate }}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" [attr.aria-label]="tKeys.SM_PRODUCT_MGMT_PAGE_CLOSE_ARIA_LABEL | translate"></button>
        </div>
        <div class="modal-body">
          <ul class="nav nav-tabs" id="productTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="basic-info-tab" data-bs-toggle="tab" data-bs-target="#basic-info"
                type="button" role="tab" aria-controls="basic-info" aria-selected="true">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_TAB_BASIC_INFO | translate }}</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="pricing-tab" data-bs-toggle="tab" data-bs-target="#pricing" type="button"
                role="tab" aria-controls="pricing" aria-selected="false">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_TAB_PRICING | translate }}</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="inventory-tab" data-bs-toggle="tab" data-bs-target="#inventory" type="button"
                role="tab" aria-controls="inventory" aria-selected="false">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_TAB_INVENTORY | translate }}</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="images-tab" data-bs-toggle="tab" data-bs-target="#images" type="button"
                role="tab" aria-controls="images" aria-selected="false">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_TAB_IMAGES | translate }}</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="variants-tab" data-bs-toggle="tab" data-bs-target="#variants" type="button"
                role="tab" aria-controls="variants" aria-selected="false">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_TAB_VARIANTS | translate }}</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="seo-tab" data-bs-toggle="tab" data-bs-target="#seo" type="button" role="tab"
                aria-controls="seo" aria-selected="false">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_TAB_SEO | translate }}</button>
            </li>
          </ul>
          <form #productForm="ngForm" (ngSubmit)="saveProduct()">
            <div class="tab-content" id="productTabsContent">
              <div class="tab-pane fade show active" id="basic-info" role="tabpanel" aria-labelledby="basic-info-tab">
                <div class="mb-3">
                  <label for="productName" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_PRODUCT_NAME_LABEL | translate }}</label>
                  <input type="text" class="form-control" id="productName" name="name"
                    [(ngModel)]="productFormModel.name" required>
                </div>
                <div class="mb-3">
                  <label for="productDescription" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_DESCRIPTION_LABEL | translate }}</label>
                  <textarea class="form-control" id="productDescription" name="description"
                    [(ngModel)]="productFormModel.description" rows="3"></textarea>
                </div>
                <div class="mb-3">
                  <label for="productSKU" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SKU_LABEL | translate }}</label>
                  <input type="text" class="form-control" id="productSKU" name="sku" [(ngModel)]="productFormModel.sku">
                </div>
                <div class="mb-3">
                  <label for="productCategory" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_CATEGORY_LABEL | translate }}</label>
                  <select class="form-select" id="productCategory" name="category"
                    [(ngModel)]="productFormModel.category" required>
                    <option value="">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SELECT_CATEGORY_OPTION | translate }}</option>
                    <!-- Category options will be dynamically loaded -->
                  </select>
                </div>
              </div>
              <div class="tab-pane fade" id="pricing" role="tabpanel" aria-labelledby="pricing-tab">
                <div class="mb-3">
                  <label for="productPrice" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_PRICE_LABEL | translate }}</label>
                  <input type="number" class="form-control" id="productPrice" name="price"
                    [(ngModel)]="productFormModel.price" step="0.01" required>
                </div>
                <div class="mb-3">
                  <label for="productSalePrice" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SALE_PRICE_LABEL | translate }}</label>
                  <input type="number" class="form-control" id="productSalePrice" name="salePrice"
                    [(ngModel)]="productFormModel.salePrice" step="0.01">
                </div>
                <div class="mb-3">
                  <label for="productTaxStatus" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_TAX_STATUS_LABEL | translate }}</label>
                  <select class="form-select" id="productTaxStatus" name="taxStatus"
                    [(ngModel)]="productFormModel.taxStatus" required>
                    <option value="taxable">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_TAX_STATUS_TAXABLE_OPTION | translate }}</option>
                    <option value="non-taxable">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_TAX_STATUS_NON_TAXABLE_OPTION | translate }}</option>
                  </select>
                </div>
              </div>
              <div class="tab-pane fade" id="inventory" role="tabpanel" aria-labelledby="inventory-tab">
                <div class="mb-3">
                  <label for="productStockQuantity" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_STOCK_QUANTITY_LABEL | translate }}</label>
                  <input type="number" class="form-control" id="productStockQuantity" name="stockQuantity"
                    [(ngModel)]="productFormModel.stockQuantity" required min="0">
                </div>
                <div class="mb-3">
                  <label for="productLowStockThreshold" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_LOW_STOCK_THRESHOLD_LABEL | translate }}</label>
                  <input type="number" class="form-control" id="productLowStockThreshold" name="lowStockThreshold"
                    [(ngModel)]="productFormModel.lowStockThreshold" min="0">
                </div>
                <div class="mb-3">
                  <label for="productStockStatus" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_STOCK_STATUS_LABEL | translate }}</label>
                  <select class="form-select" id="productStockStatus" name="stockStatus"
                    [(ngModel)]="productFormModel.stockStatus" required>
                    <option value="in-stock">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STOCK_IN_STOCK_OPTION | translate }}</option>
                    <option value="out-of-stock">{{ tKeys.SM_PRODUCT_MGMT_PAGE_FILTER_STOCK_OUT_OF_STOCK_OPTION | translate }}</option>
                  </select>
                </div>
              </div>
              <div class="tab-pane fade" id="images" role="tabpanel" aria-labelledby="images-tab">
                <div class="mb-3">
                  <label for="productImages" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_PRODUCT_IMAGES_LABEL | translate }}</label>
                  <div class="image-upload-drop-zone border rounded p-3 text-center"
                       (drop)="onImageDrop($event)"
                       (dragover)="onDragOver($event)"
                       (dragleave)="onDragLeave($event)"
                       (click)="triggerImageFileInput()">
                    <p>{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_IMAGE_DROP_ZONE_TEXT | translate }}</p>
                    <input type="file" id="productImageInput" multiple accept="image/*" style="display: none;"
                           (change)="onImageFileSelected($event)">
                    <button type="button" class="btn btn-secondary mt-2">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SELECT_FILES_BUTTON | translate }}</button>
                  </div>
                </div>
                <div class="image-preview-area row mt-3" *ngIf="imagePreviews.length > 0">
                  <div *ngFor="let preview of imagePreviews; let i = index" class="col-md-3 mb-3 image-preview-item">
                    <img [src]="preview" class="img-thumbnail" [alt]="tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_IMAGE_PREVIEW_ALT | translate">
                    <button type="button" class="btn btn-sm btn-danger remove-preview-btn" (click)="removeImagePreview(i)">
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </div>
                <div *ngIf="imagePreviews.length === 0 && productFormModel.imageUrls?.length === 0" class="text-muted">
                  {{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_NO_IMAGES_UPLOADED_TEXT | translate }}
                </div>
                 <!-- Display existing images if editing and no new previews -->
                <div class="image-preview-area row mt-3" *ngIf="imagePreviews.length === 0 && productFormModel.imageUrls?.length > 0">
                    <div *ngFor="let existingUrl of productFormModel.imageUrls; let i = index" class="col-md-3 mb-3 image-preview-item">
                        <img [src]="existingUrl" class="img-thumbnail" [alt]="tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_EXISTING_IMAGE_ALT | translate">
                        <!-- Optionally, add a way to remove existing images -->
                        <!-- <button type="button" class="btn btn-sm btn-danger remove-preview-btn" (click)="removeExistingImage(i)">
                            <i class="fas fa-times"></i>
                        </button> -->
                    </div>
                </div>
              </div>
              <div class="tab-pane fade" id="variants" role="tabpanel" aria-labelledby="variants-tab">
                <h5>{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_PRODUCT_OPTIONS_TITLE | translate }}</h5>
                <p>{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_PRODUCT_OPTIONS_DESCRIPTION | translate }}</p>
                <div class="option-types-area mb-3">
                  <div *ngFor="let optionType of currentOptionTypes; let i = index" class="input-group mb-2">
                    <input type="text" class="form-control" [placeholder]="tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_OPTION_NAME_PLACEHOLDER | translate" [(ngModel)]="optionType.name" name="optionName{{i}}" (ngModelChange)="onOptionTypeChange()">
                    <input type="text" class="form-control" [placeholder]="tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_OPTION_VALUES_PLACEHOLDER | translate" [(ngModel)]="optionType.values" name="optionValues{{i}}" (ngModelChange)="onOptionTypeChange()">
                    <button class="btn btn-outline-danger" type="button" (click)="removeOptionType(i)">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_REMOVE_OPTION_BUTTON | translate }}</button>
                  </div>
                  <button class="btn btn-secondary btn-sm me-2" type="button" (click)="addOptionType()">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_ADD_OPTION_TYPE_BUTTON | translate }}</button>
                  <button class="btn btn-info btn-sm" type="button" (click)="generateVariants()">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_GENERATE_VARIANTS_BUTTON | translate }}</button>
                </div>

                <h5 class="mt-4">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_GENERATED_VARIANTS_TITLE | translate }}</h5>
                <p *ngIf="generatedVariants.length === 0 && currentOptionTypes.length > 0" class="text-muted">
                  {{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_CLICK_GENERATE_VARIANTS_TEXT | translate }}
                </p>
                <p *ngIf="currentOptionTypes.length === 0" class="text-muted">
                  {{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_ADD_OPTION_TYPES_TEXT | translate }}
                </p>

                <div *ngIf="generatedVariants.length > 0" class="table-responsive">
                  <table class="table table-sm variant-table">
                    <thead>
                      <tr>
                        <th *ngFor="let optionName of productFormModel.options">{{ optionName }}</th>
                        <th>{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_PRICE | translate }}</th>
                        <th>{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_SKU | translate }}</th>
                        <th>{{ tKeys.SM_PRODUCT_MGMT_PAGE_TABLE_HEADER_STOCK | translate }}</th>
                        <th>{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_VARIANT_TABLE_IMAGE_URL_HEADER | translate }}</th>
                        <!-- <th>Actions</th> -->
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let variant of generatedVariants; let i = index">
                        <td *ngFor="let option of variant.options">{{ option.value }}</td>
                        <td>
                          <input type="number" class="form-control form-control-sm" [(ngModel)]="variant.price" name="variantPrice{{i}}" (change)="updateVariantDetail(i, 'price', $event)" [placeholder]="tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_VARIANT_PRICE_PLACEHOLDER | translate">
                        </td>
                        <td>
                          <input type="text" class="form-control form-control-sm" [(ngModel)]="variant.sku" name="variantSku{{i}}" (change)="updateVariantDetail(i, 'sku', $event)" [placeholder]="tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_VARIANT_SKU_PLACEHOLDER | translate">
                        </td>
                        <td>
                          <input type="number" class="form-control form-control-sm" [(ngModel)]="variant.stockLevel" name="variantStock{{i}}" (change)="updateVariantDetail(i, 'stockLevel', $event)" [placeholder]="tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_VARIANT_STOCK_PLACEHOLDER | translate">
                        </td>
                        <td>
                          <input type="text" class="form-control form-control-sm" [(ngModel)]="variant.imageUrl" name="variantImageUrl{{i}}" (change)="updateVariantDetail(i, 'imageUrl', $event)" [placeholder]="tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_VARIANT_IMAGE_URL_PLACEHOLDER | translate">
                        </td>
                        <!-- TODO: Add actions like delete individual variant if needed -->
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div class="tab-pane fade" id="seo" role="tabpanel" aria-labelledby="seo-tab">
                <div class="mb-3">
                  <label for="seoPageTitle" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SEO_PAGE_TITLE_LABEL | translate }}</label>
                  <input type="text" class="form-control" id="seoPageTitle" name="seoPageTitle"
                    [(ngModel)]="productFormModel.seoPageTitle" maxlength="60">
                  <small class="form-text text-muted">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SEO_PAGE_TITLE_RECOMMENDED_LENGTH | translate }}</small>
                </div>
                <div class="mb-3">
                  <label for="seoMetaDescription" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SEO_META_DESCRIPTION_LABEL | translate }}</label>
                  <textarea class="form-control" id="seoMetaDescription" name="seoMetaDescription"
                    [(ngModel)]="productFormModel.seoMetaDescription" rows="3" maxlength="160"></textarea>
                  <small class="form-text text-muted">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SEO_META_DESCRIPTION_RECOMMENDED_LENGTH | translate }}</small>
                </div>
                <div class="mb-3">
                  <label for="seoUrlSlug" class="form-label">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SEO_URL_SLUG_LABEL | translate }}</label>
                  <input type="text" class="form-control" id="seoUrlSlug" name="urlSlug"
                    [(ngModel)]="productFormModel.urlSlug">
                  <small class="form-text text-muted">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SEO_URL_SLUG_NOTE | translate }}</small>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                (click)="closeModal()">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_CANCEL_BUTTON | translate }}</button>
              <button type="submit" class="btn btn-primary">{{ tKeys.SM_PRODUCT_MGMT_PAGE_MODAL_SAVE_CHANGES_BUTTON | translate }}</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>